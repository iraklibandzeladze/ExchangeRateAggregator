# Laravel Currency Rates Aggregator

рЃћрЃА рЃљрЃарЃўрЃА Laravel рЃљрЃърЃџрЃўрЃЎрЃљрЃфрЃўрЃљ, рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃДрЃЮрЃЋрЃћрЃџрЃЊрЃдрЃўрЃБрЃарЃљрЃЊ рЃљрЃњрЃарЃЮрЃЋрЃћрЃЉрЃА рЃЊрЃљ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃЋрЃљрЃџрЃБрЃбрЃўрЃА рЃЎрЃБрЃарЃАрЃћрЃЉрЃА рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЦрЃЋрЃћрЃДрЃюрЃўрЃА рЃфрЃћрЃюрЃбрЃарЃљрЃџрЃБрЃарЃў рЃЉрЃљрЃюрЃЎрЃўрЃЊрЃљрЃю.  
рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ рЃњрЃљрЃюрЃЎрЃБрЃЌрЃЋрЃюрЃўрЃџрЃўрЃљ рЃњрЃљрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃљрЃЊрЃў рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃўрЃАрЃЌрЃЋрЃўрЃА Рђћ рЃљрЃ«рЃљрЃџрЃў рЃЦрЃЋрЃћрЃДрЃюрЃўрЃА рЃЊрЃљрЃЏрЃљрЃбрЃћрЃЉрЃљ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃЏрЃљрЃарЃбрЃўрЃЋрЃљрЃЊ.

## Рюе рЃцрЃБрЃюрЃЦрЃфрЃўрЃЮрЃюрЃљрЃџрЃў

- рЃўрЃдрЃћрЃЉрЃА рЃЋрЃљрЃџрЃБрЃбрЃўрЃА рЃЎрЃБрЃарЃАрЃћрЃЉрЃА:
  - ­ЪЄг­ЪЄф рЃАрЃљрЃЦрЃљрЃарЃЌрЃЋрЃћрЃџрЃЮрЃА рЃћрЃарЃЮрЃЋрЃюрЃБрЃџрЃў рЃЉрЃљрЃюрЃЎрЃў (NBG) Рђћ JSON API
  - ­ЪЄд­ЪЄ▓ рЃАрЃЮрЃЏрЃ«рЃћрЃЌрЃўрЃА рЃћрЃарЃЮрЃЋрЃюрЃБрЃџрЃў рЃЉрЃљрЃюрЃЎрЃў (CBA) Рђћ SOAP API (WSDL)
  - ­ЪЄ░­ЪЄ┐ рЃДрЃљрЃќрЃљрЃ«рЃћрЃЌрЃўрЃА рЃћрЃарЃЮрЃЋрЃюрЃБрЃџрЃў рЃЉрЃљрЃюрЃЎрЃў (NBK) Рђћ RSS XML
  - ­ЪЄд­ЪЄ┐ (рЃАрЃБрЃарЃЋрЃўрЃџрЃўрЃАрЃљрЃЏрЃћрЃЉрЃа) рЃљрЃќрЃћрЃарЃЉрЃљрЃўрЃ»рЃљрЃюрЃўрЃА рЃћрЃарЃЮрЃЋрЃюрЃБрЃџрЃў рЃЉрЃљрЃюрЃЎрЃў Рђћ XML

- рЃДрЃЋрЃћрЃџрЃљ рЃгрЃДрЃљрЃарЃЮрЃЊрЃљрЃю рЃўрЃдрЃћрЃЉрЃА **рЃДрЃЋрЃћрЃџрЃљ рЃЋрЃљрЃџрЃБрЃбрЃљрЃА**, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃўрЃюрЃљрЃ«рЃљрЃЋрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ:
  - **USD** (рЃљрЃерЃе рЃЊрЃЮрЃџрЃљрЃарЃў)
  - **EUR** (рЃћрЃЋрЃарЃЮ)

- рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃў рЃўрЃюрЃљрЃ«рЃћрЃЉрЃљ рЃфрЃ«рЃарЃўрЃџрЃерЃў `exchange_rates`:
  - рЃћрЃарЃЌ рЃЕрЃљрЃюрЃљрЃгрЃћрЃарЃА рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃљрЃЋрЃА: **country + currency_code + date**
  - `upsert()` рЃБрЃќрЃарЃБрЃюрЃЋрЃћрЃџрЃДрЃЮрЃцрЃА **рЃЊрЃБрЃЉрЃџрЃўрЃЎрЃљрЃбрЃћрЃЉрЃўрЃА рЃљрЃарЃљрЃарЃАрЃћрЃЉрЃЮрЃЉрЃљрЃА**.

- рЃАрЃўрЃАрЃбрЃћрЃЏрЃљ рЃљрЃЋрЃбрЃЮрЃЏрЃљрЃбрЃБрЃарЃљрЃЊ рЃўрЃФрЃљрЃ«рЃћрЃЉрЃљ cron / scheduler-рЃўрЃА рЃЏрЃћрЃерЃЋрЃћрЃЮрЃЉрЃўрЃЌ.

- рЃЏрЃўрЃюрЃўрЃЏрЃљрЃџрЃБрЃарЃў API:
  - `/api/exchange-rates/history` Рђћ рЃЉрЃЮрЃџрЃЮ 7 рЃЊрЃдрЃўрЃА рЃўрЃАрЃбрЃЮрЃарЃўрЃљ (+ рЃцрЃўрЃџрЃбрЃарЃў `?country=GE|AM|KZ|AZ`)



---

## ­ЪД▒ рЃљрЃарЃЦрЃўрЃбрЃћрЃЦрЃбрЃБрЃарЃљ

```bash
app/
 РћюРћђРћђ Contracts/
 Рћѓ    РћћРћђРћђ ExchangeRateProviderInterface.php   # рЃћрЃарЃЌрЃўрЃљрЃюрЃў рЃЎрЃЮрЃюрЃбрЃарЃљрЃЦрЃбрЃў
 РћюРћђРћђ DTO/
 Рћѓ    РћћРћђРћђ ExchangeRateDTO.php                 # рЃбрЃарЃљрЃюрЃАрЃърЃЮрЃарЃб рЃЮрЃЉрЃўрЃћрЃЦрЃбрЃў
 РћюРћђРћђ Services/
 Рћѓ    РћюРћђРћђ Nbg.php                             # GE JSON Provider
 Рћѓ    РћюРћђРћђ Cba.php                             # AM SOAP Provider
 Рћѓ    РћюРћђРћђ Nbk.php                             # KZ RSS Provider
 Рћѓ    РћћРћђРћђ ExchangeRateAggregator.php          # рЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃћрЃЉрЃА рЃДрЃЋрЃћрЃџрЃљ рЃърЃарЃЮрЃЋрЃљрЃўрЃЊрЃћрЃарЃА
 РћюРћђРћђ Console/Commands/
 Рћѓ    РћћРћђРћђ FetchRates.php                      # рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў Command (upsert)
 РћћРћђРћђ Http/Controllers/
      РћћРћђРћђ ExchangeRateHistoryController.php   # рЃўрЃАрЃбрЃЮрЃарЃўрЃўрЃА API endpoint


## ­ЪЊд рЃњрЃљрЃюрЃљрЃЌрЃљрЃЋрЃАрЃћрЃЉрЃљ / рЃњрЃљрЃерЃЋрЃћрЃЉрЃљ

```bash
git clone <repo-url>
cd <project>
composer install
cp .env.example .env
php artisan key:generate


рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃЌрЃљ рЃЉрЃљрЃќрЃљ:
php artisan migrate


рЃАрЃЮрЃЏрЃ«рЃћрЃЌрЃўрЃА рЃЉрЃљрЃюрЃЎрЃўрЃАрЃЌрЃЋрЃўрЃА рЃАрЃљрЃГрЃўрЃарЃЮрЃљ SOAP рЃњрЃљрЃцрЃљрЃарЃЌрЃЮрЃћрЃЉрЃљ:
sudo apt-get install -y php-soap
sudo phpenmod soap
sudo service php-fpm restart


­Ъћё рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃўрЃА рЃњрЃљрЃюрЃљрЃ«рЃџрЃћрЃЉрЃљ (рЃ«рЃћрЃџрЃўрЃЌ)
php artisan rates:fetch

РЈ▒ Scheduler (Cron)
crontab -e


* * * * * php /path/to/project/artisan schedule:run >> /dev/null 2>&1
Laravel Kernel рЃБрЃЎрЃЋрЃћ рЃњрЃљрЃюрЃАрЃљрЃќрЃдрЃЋрЃарЃБрЃџрЃўрЃљ рЃДрЃЮрЃЋрЃћрЃџрЃЊрЃдрЃћ 08:00-рЃќрЃћ (Asia/Tbilisi):

$schedule->command('rates:fetch')
    ->timezone('Asia/Tbilisi')
    ->dailyAt('09:30');

